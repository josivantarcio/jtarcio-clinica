2025-08-26T16:42:06.0362446Z ##[group]Run export NODE_ENV=test
2025-08-26T16:42:06.0362934Z [36;1mexport NODE_ENV=test[0m
2025-08-26T16:42:06.0364198Z [36;1mexport DATABASE_URL="***localhost:5433/eo_clinica_db"[0m
2025-08-26T16:42:06.0365312Z [36;1mexport DATABASE_URL_TEST="***localhost:5433/eo_clinica_db"[0m
2025-08-26T16:42:06.0366256Z [36;1mnpm test -- tests/security/basic-security.test.ts --testTimeout=30000 --maxWorkers=1[0m
2025-08-26T16:42:06.0476000Z shell: /usr/bin/bash -e {0}
2025-08-26T16:42:06.0476395Z ##[endgroup]
2025-08-26T16:42:06.2206887Z 
2025-08-26T16:42:06.2211942Z > eo-clinica-system@1.3.4 test
2025-08-26T16:42:06.2237043Z > jest tests/security/basic-security.test.ts --testTimeout=30000 --maxWorkers=1
2025-08-26T16:42:06.2241667Z 
2025-08-26T16:42:12.2021990Z   console.log
2025-08-26T16:42:12.2023875Z     ✅ Criptografia: bcrypt com salt 12 funcionando
2025-08-26T16:42:12.2024257Z 
2025-08-26T16:42:12.2024662Z       at Object.<anonymous> (tests/security/basic-security.test.ts:37:21)
2025-08-26T16:42:12.2025209Z 
2025-08-26T16:42:12.2082469Z   console.log
2025-08-26T16:42:12.2084115Z     ✅ Criptografia: AES-256 implementado
2025-08-26T16:42:12.2084461Z 
2025-08-26T16:42:12.2084863Z       at Object.<anonymous> (tests/security/basic-security.test.ts:55:21)
2025-08-26T16:42:12.2085428Z 
2025-08-26T16:42:12.2102789Z   console.log
2025-08-26T16:42:12.2103714Z     ✅ Criptografia: Tokens seguros gerados
2025-08-26T16:42:12.2104053Z 
2025-08-26T16:42:12.2104459Z       at Object.<anonymous> (tests/security/basic-security.test.ts:68:21)
2025-08-26T16:42:12.2104976Z 
2025-08-26T16:42:12.2123996Z   console.log
2025-08-26T16:42:12.2125649Z     ✅ Validação: Formato de email validado
2025-08-26T16:42:12.2126029Z 
2025-08-26T16:42:12.2126453Z       at Object.<anonymous> (tests/security/basic-security.test.ts:92:21)
2025-08-26T16:42:12.2127018Z 
2025-08-26T16:42:12.2164709Z   console.log
2025-08-26T16:42:12.2165572Z     ✅ Validação: CPF brasileiro validado
2025-08-26T16:42:12.2166142Z 
2025-08-26T16:42:12.2166728Z       at Object.<anonymous> (tests/security/basic-security.test.ts:135:21)
2025-08-26T16:42:12.2167764Z 
2025-08-26T16:42:12.2271605Z   console.log
2025-08-26T16:42:12.2272554Z     ✅ Validação: XSS sanitização implementada
2025-08-26T16:42:12.2273134Z 
2025-08-26T16:42:12.2273772Z       at Object.<anonymous> (tests/security/basic-security.test.ts:161:21)
2025-08-26T16:42:12.2274464Z 
2025-08-26T16:42:12.2295541Z   console.log
2025-08-26T16:42:12.2296334Z     ✅ Rate Limiting: Delay exponencial implementado
2025-08-26T16:42:12.2296699Z 
2025-08-26T16:42:12.2297047Z       at Object.<anonymous> (tests/security/basic-security.test.ts:176:21)
2025-08-26T16:42:12.2297673Z 
2025-08-26T16:42:12.2313182Z   console.log
2025-08-26T16:42:12.2314713Z     ✅ Rate Limiting: Detecção força bruta funcionando
2025-08-26T16:42:12.2315906Z 
2025-08-26T16:42:12.2316568Z       at Object.<anonymous> (tests/security/basic-security.test.ts:194:21)
2025-08-26T16:42:12.2317580Z 
2025-08-26T16:42:12.3087877Z   console.log
2025-08-26T16:42:12.3089488Z     ⚠️ API Security: Servidor offline - não foi possível testar 404
2025-08-26T16:42:12.3090303Z 
2025-08-26T16:42:12.3092296Z       at Object.<anonymous> (tests/security/basic-security.test.ts:214:29)
2025-08-26T16:42:12.3092819Z 
2025-08-26T16:42:12.3136208Z   console.log
2025-08-26T16:42:12.3139757Z     ⚠️ API Security: Não foi possível testar headers (servidor pode estar offline)
2025-08-26T16:42:12.3140841Z 
2025-08-26T16:42:12.3142733Z       at Object.<anonymous> (tests/security/basic-security.test.ts:245:25)
2025-08-26T16:42:12.3143785Z 
2025-08-26T16:42:12.3168481Z   console.log
2025-08-26T16:42:12.3169457Z     ⚠️ API Security: Teste CORS pode falhar se API offline
2025-08-26T16:42:12.3170439Z 
2025-08-26T16:42:12.3171056Z       at Object.<anonymous> (tests/security/basic-security.test.ts:264:25)
2025-08-26T16:42:12.3171895Z 
2025-08-26T16:42:12.3186838Z   console.log
2025-08-26T16:42:12.3188023Z     ✅ Mobile: Validações de campo adequadas
2025-08-26T16:42:12.3189338Z 
2025-08-26T16:42:12.3189972Z       at Object.<anonymous> (tests/security/basic-security.test.ts:286:21)
2025-08-26T16:42:12.3191849Z 
2025-08-26T16:42:12.3206619Z   console.log
2025-08-26T16:42:12.3207776Z     ✅ Mobile: Critérios senha forte implementados
2025-08-26T16:42:12.3208196Z 
2025-08-26T16:42:12.3208924Z       at Object.<anonymous> (tests/security/basic-security.test.ts:319:21)
2025-08-26T16:42:12.3209792Z 
2025-08-26T16:42:12.3225884Z   console.log
2025-08-26T16:42:12.3226803Z     ✅ Utilitários: IDs únicos seguros gerados
2025-08-26T16:42:12.3229138Z 
2025-08-26T16:42:12.3229609Z       at Object.<anonymous> (tests/security/basic-security.test.ts:337:17)
2025-08-26T16:42:12.3230136Z 
2025-08-26T16:42:13.8253385Z   console.log
2025-08-26T16:42:13.8254825Z     ✅ Utilitários: Timeout para operações implementado
2025-08-26T16:42:13.8255650Z 
2025-08-26T16:42:13.8261717Z       at Object.<anonymous> (tests/security/basic-security.test.ts:362:17)
2025-08-26T16:42:13.8262239Z 
2025-08-26T16:42:13.8354300Z PASS tests/security/basic-security.test.ts (6.865 s)
2025-08-26T16:42:13.8358803Z   🔒 Segurança Básica - Validações Fundamentais
2025-08-26T16:42:13.8359886Z     🔐 Criptografia e Hashing
2025-08-26T16:42:13.8361100Z       ✓ deve usar bcrypt para hash de senhas com salt adequado (723 ms)
2025-08-26T16:42:13.8362692Z       ✓ deve implementar criptografia AES-256 para dados sensíveis (5 ms)
2025-08-26T16:42:13.8363942Z       ✓ deve gerar tokens seguros para sessões (2 ms)
2025-08-26T16:42:13.8365039Z     🛡️ Validação de Dados e Sanitização
2025-08-26T16:42:13.8373850Z       ✓ deve validar formatos de email seguros (2 ms)
2025-08-26T16:42:13.8374562Z       ✓ deve validar CPF brasileiro (3 ms)
2025-08-26T16:42:13.8375214Z       ✓ deve sanitizar entrada XSS (12 ms)
2025-08-26T16:42:13.8375899Z     🚦 Rate Limiting e Proteção
2025-08-26T16:42:13.8376783Z       ✓ deve implementar delay exponencial para tentativas de login (1 ms)
2025-08-26T16:42:13.8378185Z       ✓ deve detectar padrões de ataque por força bruta (1 ms)
2025-08-26T16:42:13.8378845Z     🌐 Testes de API Security
2025-08-26T16:42:13.8379553Z       ✓ deve retornar status 404 para rotas inexistentes (77 ms)
2025-08-26T16:42:13.8380328Z       ✓ deve ter headers de segurança básicos (5 ms)
2025-08-26T16:42:13.8381077Z       ✓ deve implementar CORS adequadamente (2 ms)
2025-08-26T16:42:13.8381682Z     📱 Validações Mobile
2025-08-26T16:42:13.8382406Z       ✓ deve validar tamanhos de campo adequados para mobile (1 ms)
2025-08-26T16:42:13.8383216Z       ✓ deve ter critérios de senha forte (2 ms)
2025-08-26T16:42:13.8383809Z   🔧 Utilitários de Segurança
2025-08-26T16:42:13.8384364Z     ✓ deve gerar IDs únicos seguros (1 ms)
2025-08-26T16:42:13.8385118Z     ✓ deve implementar timeout para operações críticas (1503 ms)
2025-08-26T16:42:13.8386024Z 
2025-08-26T16:42:13.8402090Z Test Suites: 1 passed, 1 total
2025-08-26T16:42:13.8402592Z Tests:       15 passed, 15 total
2025-08-26T16:42:13.8403006Z Snapshots:   0 total
2025-08-26T16:42:13.8403348Z Time:        7.065 s
2025-08-26T16:42:13.8403992Z Ran all test suites matching /tests\/security\/basic-security.test.ts/i.
